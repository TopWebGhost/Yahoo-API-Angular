"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var favorites_state_1 = require("./favorites.state");
var index_1 = require("./index");
var initialState = new favorites_state_1.FavoritesInitialState();
exports.favoritesReducer = function (state, _a) {
    if (state === void 0) { state = initialState; }
    var payload = _a.payload, type = _a.type;
    switch (type) {
        case index_1.FavoritesActions.CHANGE_ORDER:
            return state.set(index_1.FavoritesStateKeys.Order, payload);
        case index_1.FavoritesActions.SORT_DATA:
            return state.set(index_1.FavoritesStateKeys.Data, sortData(state.data, state.order));
        case index_1.FavoritesActions.FETCH_FULFILLED:
            return state.set(index_1.FavoritesStateKeys.Data, sortData(payload, state.order));
        case index_1.FavoritesActions.FETCH_LOADER:
            return state.set(index_1.FavoritesStateKeys.Loader, payload);
        case index_1.FavoritesActions.FETCH_ERROR:
            return state.set(index_1.FavoritesStateKeys.Error, payload);
        default:
            return state;
    }
};
function sortData(data, order) {
    data = data.map(function (item) {
        var index = order.indexOf(item.symbol);
        if (index < 0) {
            index = 999;
        }
        item.index = index;
        return item;
    });
    return _.sortBy(data, ['index']);
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC93YXRjaGxpc3Qvc2lkZWJhci9mYXZvcml0ZXMvc3RhdGUvZmF2b3JpdGVzLnJlZHVjZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFJQSxxREFBMEQ7QUFDMUQsaUNBSWlCO0FBSWpCLElBQU0sWUFBWSxHQUEyQixJQUFJLHVDQUFxQixFQUE2QixDQUFDO0FBRXZGLFFBQUEsZ0JBQWdCLEdBQzNCLFVBQUMsS0FBNEMsRUFBRSxFQUF1QjtJQUFyRSxzQkFBQSxFQUFBLG9CQUE0QztRQUFHLG9CQUFPLEVBQUUsY0FBSTtJQUMzRCxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ2IsS0FBSyx3QkFBZ0IsQ0FBQyxZQUFZO1lBQ2hDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLDBCQUFrQixDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN0RCxLQUFLLHdCQUFnQixDQUFDLFNBQVM7WUFDN0IsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsMEJBQWtCLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQy9FLEtBQUssd0JBQWdCLENBQUMsZUFBZTtZQUNuQyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQywwQkFBa0IsQ0FBQyxJQUFJLEVBQUUsUUFBUSxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUM1RSxLQUFLLHdCQUFnQixDQUFDLFlBQVk7WUFDaEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsMEJBQWtCLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZELEtBQUssd0JBQWdCLENBQUMsV0FBVztZQUMvQixNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQywwQkFBa0IsQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdEQ7WUFDRSxNQUFNLENBQUMsS0FBSyxDQUFDO0lBQ2pCLENBQUM7QUFDSCxDQUFDLENBQUM7QUFHSixrQkFBa0IsSUFBeUIsRUFBRSxLQUFjO0lBQ3pELElBQUksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLFVBQUMsSUFBdUI7UUFDdEMsSUFBSSxLQUFLLEdBQVUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDOUMsRUFBRSxDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDZCxLQUFLLEdBQUcsR0FBRyxDQUFDO1FBQ2QsQ0FBQztRQUNELElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1FBQ25CLE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFDZCxDQUFDLENBQUMsQ0FBQztJQUNILE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7QUFDbkMsQ0FBQyIsImZpbGUiOiJhcHAvd2F0Y2hsaXN0L3NpZGViYXIvZmF2b3JpdGVzL3N0YXRlL2Zhdm9yaXRlcy5yZWR1Y2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWN0aW9uUmVkdWNlcixcbiAgQWN0aW9uXG59IGZyb20gJ0BuZ3J4L3N0b3JlJztcbmltcG9ydCB7IEZhdm9yaXRlc0luaXRpYWxTdGF0ZSB9IGZyb20gJy4vZmF2b3JpdGVzLnN0YXRlJztcbmltcG9ydCB7XG4gIEZhdm9yaXRlc0FjdGlvbnMsXG4gIEZhdm9yaXRlc1N0YXRlS2V5cyxcbiAgRmF2b3JpdGVzU3RhdGVJbnRlcmZhY2Vcbn0gZnJvbSAnLi9pbmRleCc7XG5pbXBvcnQgeyBTdG9ja0RhdGFJbnRlcmZhY2UgfSBmcm9tICcuLi8uLi8uLi9zdGF0ZS93YXRjaGxpc3Quc3RhdGUnO1xuZGVjbGFyZSBsZXQgXzphbnk7XG5cbmNvbnN0IGluaXRpYWxTdGF0ZTpGYXZvcml0ZXNTdGF0ZUludGVyZmFjZSA9IG5ldyBGYXZvcml0ZXNJbml0aWFsU3RhdGUoKSBhcyBGYXZvcml0ZXNTdGF0ZUludGVyZmFjZTtcblxuZXhwb3J0IGNvbnN0IGZhdm9yaXRlc1JlZHVjZXI6QWN0aW9uUmVkdWNlcjxGYXZvcml0ZXNTdGF0ZUludGVyZmFjZT4gPVxuICAoc3RhdGU6RmF2b3JpdGVzU3RhdGVJbnRlcmZhY2UgPSBpbml0aWFsU3RhdGUsIHtwYXlsb2FkLCB0eXBlfTogQWN0aW9uKSA9PiB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlIEZhdm9yaXRlc0FjdGlvbnMuQ0hBTkdFX09SREVSOlxuICAgICAgICByZXR1cm4gc3RhdGUuc2V0KEZhdm9yaXRlc1N0YXRlS2V5cy5PcmRlciwgcGF5bG9hZCk7XG4gICAgICBjYXNlIEZhdm9yaXRlc0FjdGlvbnMuU09SVF9EQVRBOlxuICAgICAgICByZXR1cm4gc3RhdGUuc2V0KEZhdm9yaXRlc1N0YXRlS2V5cy5EYXRhLCBzb3J0RGF0YShzdGF0ZS5kYXRhLCBzdGF0ZS5vcmRlcikpO1xuICAgICAgY2FzZSBGYXZvcml0ZXNBY3Rpb25zLkZFVENIX0ZVTEZJTExFRDpcbiAgICAgICAgcmV0dXJuIHN0YXRlLnNldChGYXZvcml0ZXNTdGF0ZUtleXMuRGF0YSwgc29ydERhdGEocGF5bG9hZCwgc3RhdGUub3JkZXIpKTtcbiAgICAgIGNhc2UgRmF2b3JpdGVzQWN0aW9ucy5GRVRDSF9MT0FERVI6XG4gICAgICAgIHJldHVybiBzdGF0ZS5zZXQoRmF2b3JpdGVzU3RhdGVLZXlzLkxvYWRlciwgcGF5bG9hZCk7XG4gICAgICBjYXNlIEZhdm9yaXRlc0FjdGlvbnMuRkVUQ0hfRVJST1I6XG4gICAgICAgIHJldHVybiBzdGF0ZS5zZXQoRmF2b3JpdGVzU3RhdGVLZXlzLkVycm9yLCBwYXlsb2FkKTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBzdGF0ZTtcbiAgICB9XG4gIH07XG5cblxuZnVuY3Rpb24gc29ydERhdGEoZGF0YTpTdG9ja0RhdGFJbnRlcmZhY2VbXSwgb3JkZXI6c3RyaW5nW10pOlN0b2NrRGF0YUludGVyZmFjZVtdIHtcbiAgZGF0YSA9IGRhdGEubWFwKChpdGVtOlN0b2NrRGF0YUludGVyZmFjZSkgPT4ge1xuICAgIGxldCBpbmRleDpudW1iZXIgPSBvcmRlci5pbmRleE9mKGl0ZW0uc3ltYm9sKTtcbiAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICBpbmRleCA9IDk5OTtcbiAgICB9XG4gICAgaXRlbS5pbmRleCA9IGluZGV4O1xuICAgIHJldHVybiBpdGVtO1xuICB9KTtcbiAgcmV0dXJuIF8uc29ydEJ5KGRhdGEsIFsnaW5kZXgnXSk7XG59XG4iXX0=
